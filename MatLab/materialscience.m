% Data Input for All Materials
materials = { ...
    'Polyethylene Terephthalate', 'Polypropylene', 'Stainless Steel', ...
    'Copper', 'Polyurethane', 'Brass', 'Zinc', 'Aluminium', 'Sapphire', ...
    'Magnesia', 'Medium Density Polyethylene', 'Low Density Polyethylene', ...
    'High Density Polyethylene', 'Polystyrene', 'Silica', 'Iron', 'Silicon', ...
    'Graphite', 'Platinum', 'Fused Alumina', 'Alumina', 'Plexiglass', ...
    'Wood Reinforced Acrylic', 'Steel', 'Charcoal', 'Glass Fiber-Reinforced Epoxy', ...
    'Natural Rubber', 'Carbon Nanotubes', 'Porous Carbon', 'Borosilicate', ...
    'Soda-Lime Glass', 'Graphene', 'Boron Nitride Nanotube', 'Wood Fiber', ...
    'Polyvinyl Chloride', 'Wax', 'Teflon'};

% Liquid densities (g/cm続)
rho_l = [1.38, 0.90, 7.9, 8.96, 1.1, 8.0, 7.14, 2.70, NaN, ...
         NaN, 0.93, 0.91, 0.94, 1.04, NaN, 7.00, NaN, NaN, 19.77, ...
         NaN, NaN, 1.14, NaN, 7.00, NaN, NaN, NaN, NaN, NaN, ...
         NaN, NaN, NaN, NaN, 1.30, NaN, NaN];

% Solid densities (g/cm続)
rho_s = [1.33, 0.85, 7.75, 8.02, 1.05, 8.4, 6.57, 2.38, 3.98, ...
         3.58, 0.97, 0.94, 0.97, 1.02, 2.65, 7.87, 2.33, 2.25, 21.45, ...
         3.97, 4.10, 1.18, NaN, 7.80, 1.50, 1.80, 0.92, 1.30, 0.20, ...
         2.23, 2.50, 2.26, 2.25, 1.38, 0.93, 2.20];

% Melting/Decomposition Temperatures (K)
T_m = [543, 465, 1712, 1358, 523, 1211, 693, 933, 2303, ...
       3073, 363, 343, 373, 513, 1988, 1811, 1687, 3800, 2041, ...
       2345, 2323, 403, NaN, 1816, NaN, 523, 500, 3700, NaN, ...
       1223, 1423, NaN, 3273, 483, 330, 610];

% Check for missing values and filter valid data
valid_idx = ~isnan(rho_l) & ~isnan(rho_s) & ~isnan(T_m);
valid_materials = materials(valid_idx);
rho_l_valid = rho_l(valid_idx);
rho_s_valid = rho_s(valid_idx);
T_m_valid = T_m(valid_idx);

% Calculate density change (Delta rho_k in kg/m続)
delta_rho = abs(rho_s_valid - rho_l_valid); % Density change from solid to liquid (g/cm続)
delta_rho_k = abs((rho_l_valid .* delta_rho) ./ rho_s_valid) * 1000; % Convert to kg/m^3

% Plot results
figure;
scatter(T_m_valid, delta_rho_k, 'filled');
title('Density Change vs Melting/Decomposition Temperature');
xlabel('Melting/Decomposition Temperature (K)');
ylabel('Density Change (\Delta\rho_k, kg/m^3)');
grid on;

% Annotate plot with material names
for i = 1:length(valid_materials)
    text(T_m_valid(i), delta_rho_k(i), valid_materials{i}, 'VerticalAlignment', 'bottom', 'HorizontalAlignment', 'right');
end
